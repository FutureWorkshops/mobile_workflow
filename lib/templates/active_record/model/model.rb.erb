<% module_namespacing do -%>
class <%= class_name %> < <%= parent_class_name.classify %>
  # Enable if you need to generate attachment URLs
  # include Rails.application.routes.url_helpers
  
<% attributes.select(&:reference?).each do |attribute| -%>
  belongs_to :<%= attribute.name %><%= ', polymorphic: true' if attribute.polymorphic? %>
<% end -%>
<% attributes.select(&:attachment?).each do |attribute| -%>
  has_one_attached :<%= attribute.name %>
<% end -%>
<% attributes.select(&:attachments?).each do |attribute| -%>
  has_many_attached :<%= attribute.name %>
<% end -%>

  def list_item_as_json
    {
      id: id,
      text: text,
      # detailText: nil,
      # sfSymbolName: nil,
      # imageURL: preview_url(image, height: 100, width: 100)
    }
  end
  
  def display_as_json
    [
      {label: "ID", text: id, mimeType: 'text/plain'},
      {label: "Text", text: text, mimeType: 'text/plain'},
      #{previewURL: preview_url(image, height: 300, width: 600), url: attachment_url(image), mimeType: 'image/jpg'},
      #{previewURL: preview_url(video, height: 300, width: 600), url: attachment_url(video), mimeType: 'video/mp4'},
      #{label: "Approve", url: approval_path(self), method: :put, mimeType: 'application/url'}
    ]
  end

end
<% end -%>